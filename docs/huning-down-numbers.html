<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Piecemeal R</title>
  <meta name="description" content="This is a R tutorial.">
  <meta name="generator" content="bookdown 0.3.14 and GitBook 2.6.7">

  <meta property="og:title" content="Piecemeal R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a R tutorial." />
  <meta name="github-repo" content="/kotamine/piecemealR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Piecemeal R" />
  
  <meta name="twitter:description" content="This is a R tutorial." />
  

<meta name="author" content="Kota Minegishi">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="arts-carfts.html">
<link rel="next" href="reflections.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Piecemeal R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="a-few-words.html"><a href="a-few-words.html"><i class="fa fa-check"></i><b>1.1</b> A Few Words</a></li>
<li class="chapter" data-level="1.2" data-path="materials.html"><a href="materials.html"><i class="fa fa-check"></i><b>1.2</b> Materials</a></li>
<li class="chapter" data-level="1.3" data-path="arts-carfts.html"><a href="arts-carfts.html"><i class="fa fa-check"></i><b>1.3</b> Arts &amp; Carfts</a><ul>
<li class="chapter" data-level="" data-path="arts-carfts.html"><a href="arts-carfts.html#crafts"><i class="fa fa-check"></i>Crafts</a></li>
<li class="chapter" data-level="" data-path="arts-carfts.html"><a href="arts-carfts.html#arts"><i class="fa fa-check"></i>Arts</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="huning-down-numbers.html"><a href="huning-down-numbers.html"><i class="fa fa-check"></i><b>1.4</b> Huning down numbers</a></li>
<li class="chapter" data-level="1.5" data-path="reflections.html"><a href="reflections.html"><i class="fa fa-check"></i><b>1.5</b> Reflections</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="essentials.html"><a href="essentials.html"><i class="fa fa-check"></i><b>2</b> Essentials</a><ul>
<li class="chapter" data-level="2.1" data-path="cheatsheets.html"><a href="cheatsheets.html"><i class="fa fa-check"></i><b>2.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.2" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>2.2</b> Data types</a><ul>
<li class="chapter" data-level="" data-path="data-types.html"><a href="data-types.html#atomic"><i class="fa fa-check"></i>Atomic</a></li>
<li class="chapter" data-level="" data-path="data-types.html"><a href="data-types.html#factor"><i class="fa fa-check"></i>Factor</a></li>
<li class="chapter" data-level="" data-path="data-types.html"><a href="data-types.html#matrix"><i class="fa fa-check"></i>Matrix</a></li>
<li class="chapter" data-level="" data-path="data-types.html"><a href="data-types.html#data-frame"><i class="fa fa-check"></i>Data Frame</a></li>
<li class="chapter" data-level="" data-path="data-types.html"><a href="data-types.html#list"><i class="fa fa-check"></i>List</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>2.3</b> Programming</a><ul>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#operator"><i class="fa fa-check"></i>Operator</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#if-else"><i class="fa fa-check"></i>If else</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#loop"><i class="fa fa-check"></i>Loop</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#environment"><i class="fa fa-check"></i>Environment</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#debugging"><i class="fa fa-check"></i>Debugging</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#stat-func."><i class="fa fa-check"></i>Stat func.</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#string-func."><i class="fa fa-check"></i>String func.</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#set-func."><i class="fa fa-check"></i>Set func.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="housekeeping.html"><a href="housekeeping.html"><i class="fa fa-check"></i><b>2.4</b> Housekeeping</a><ul>
<li class="chapter" data-level="" data-path="housekeeping.html"><a href="housekeeping.html#working-directory"><i class="fa fa-check"></i>Working directory</a></li>
<li class="chapter" data-level="" data-path="housekeeping.html"><a href="housekeeping.html#r-session"><i class="fa fa-check"></i>R session</a></li>
<li class="chapter" data-level="" data-path="housekeeping.html"><a href="housekeeping.html#save-load"><i class="fa fa-check"></i>Save &amp; load</a></li>
<li class="chapter" data-level="" data-path="housekeeping.html"><a href="housekeeping.html#input-output"><i class="fa fa-check"></i>Input &amp; Output</a></li>
<li class="chapter" data-level="" data-path="housekeeping.html"><a href="housekeeping.html#updating"><i class="fa fa-check"></i>Updating</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="good-to-knows.html"><a href="good-to-knows.html"><i class="fa fa-check"></i><b>3</b> Good-to-Knows</a></li>
<li class="chapter" data-level="4" data-path="piecemeal-top.html"><a href="piecemeal-top.html"><i class="fa fa-check"></i><b>4</b> Piecemeal Topics</a><ul>
<li class="chapter" data-level="4.1" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>4.1</b> Unusual Deaths in Mexico</a><ul>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#materials-1"><i class="fa fa-check"></i>Materials</a></li>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#arts-crafts"><i class="fa fa-check"></i>Arts &amp; Crafts</a></li>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#exercise"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#the-key"><i class="fa fa-check"></i>The Key</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="next.html"><a href="next.html"><i class="fa fa-check"></i><b>4.2</b> Upcoming topics</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>5</b> Resources</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org/yihui/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Piecemeal R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="huning-down-numbers" class="section level2">
<h2><span class="header-section-number">1.4</span> Huning down numbers</h2>
<p>If not airports, are airlines to blame for the delays? Previously, we saw that some airlines have higher mean delays than others for the case of NYC-MSP flights. Let’s look at the overall averages by carrier.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stat_carrier &lt;-<span class="st"> </span>flights %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(carrier) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n_obs =</span> <span class="kw">n</span>(),
            <span class="dt">dep_delay =</span> <span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">arr_delay =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
            ) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">left_join</span>(airlines, <span class="dt">by=</span><span class="st">&quot;carrier&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(n_obs)) 

stat_carrier %&gt;%<span class="st"> </span><span class="kw">kable</span>(<span class="dt">digit=</span><span class="dv">2</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">carrier</th>
<th align="right">n_obs</th>
<th align="right">dep_delay</th>
<th align="right">arr_delay</th>
<th align="left">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">UA</td>
<td align="right">58665</td>
<td align="right">12.11</td>
<td align="right">3.56</td>
<td align="left">United Air Lines Inc.</td>
</tr>
<tr class="even">
<td align="left">B6</td>
<td align="right">54635</td>
<td align="right">13.02</td>
<td align="right">9.46</td>
<td align="left">JetBlue Airways</td>
</tr>
<tr class="odd">
<td align="left">EV</td>
<td align="right">54173</td>
<td align="right">19.96</td>
<td align="right">15.80</td>
<td align="left">ExpressJet Airlines Inc.</td>
</tr>
<tr class="even">
<td align="left">DL</td>
<td align="right">48110</td>
<td align="right">9.26</td>
<td align="right">1.64</td>
<td align="left">Delta Air Lines Inc.</td>
</tr>
<tr class="odd">
<td align="left">AA</td>
<td align="right">32729</td>
<td align="right">8.59</td>
<td align="right">0.36</td>
<td align="left">American Airlines Inc.</td>
</tr>
<tr class="even">
<td align="left">MQ</td>
<td align="right">26397</td>
<td align="right">10.55</td>
<td align="right">10.77</td>
<td align="left">Envoy Air</td>
</tr>
<tr class="odd">
<td align="left">US</td>
<td align="right">20536</td>
<td align="right">3.78</td>
<td align="right">2.13</td>
<td align="left">US Airways Inc.</td>
</tr>
<tr class="even">
<td align="left">9E</td>
<td align="right">18460</td>
<td align="right">16.73</td>
<td align="right">7.38</td>
<td align="left">Endeavor Air Inc.</td>
</tr>
<tr class="odd">
<td align="left">WN</td>
<td align="right">12275</td>
<td align="right">17.71</td>
<td align="right">9.65</td>
<td align="left">Southwest Airlines Co.</td>
</tr>
<tr class="even">
<td align="left">VX</td>
<td align="right">5162</td>
<td align="right">12.87</td>
<td align="right">1.76</td>
<td align="left">Virgin America</td>
</tr>
<tr class="odd">
<td align="left">FL</td>
<td align="right">3260</td>
<td align="right">18.73</td>
<td align="right">20.12</td>
<td align="left">AirTran Airways Corporation</td>
</tr>
<tr class="even">
<td align="left">AS</td>
<td align="right">714</td>
<td align="right">5.80</td>
<td align="right">-9.93</td>
<td align="left">Alaska Airlines Inc.</td>
</tr>
<tr class="odd">
<td align="left">F9</td>
<td align="right">685</td>
<td align="right">20.22</td>
<td align="right">21.92</td>
<td align="left">Frontier Airlines Inc.</td>
</tr>
<tr class="even">
<td align="left">YV</td>
<td align="right">601</td>
<td align="right">19.00</td>
<td align="right">15.56</td>
<td align="left">Mesa Airlines Inc.</td>
</tr>
<tr class="odd">
<td align="left">HA</td>
<td align="right">342</td>
<td align="right">4.90</td>
<td align="right">-6.92</td>
<td align="left">Hawaiian Airlines Inc.</td>
</tr>
<tr class="even">
<td align="left">OO</td>
<td align="right">32</td>
<td align="right">12.59</td>
<td align="right">11.93</td>
<td align="left">SkyWest Airlines Inc.</td>
</tr>
</tbody>
</table>
<p>There seems to be some differences. However, we need to remember that our dataset covers only the flights from New York City, which may not be representative of all hub airprots across the United States. The table shows simple averages of delays across various routes, days, and hours of flights that may systematically differ across carriers, who use differenet airports around the country as their hubs. Moreover, the concept of “delay” is complicated because it is with reference to the scheduled depature and arrival times, which may differ by carrier (e.g., think of the time sitting in the airplane before taking off and after landing).</p>
<p>For our purposes, lets see whether the average air time differs across carriers by accounting for flight’s destinatination and timing.<br />
(It would be more interesting to use schduled flight duration from depature to arrival for each flight instead of air time, but the calculation is complicated with our data.) Let’s first check how air time relates to flight distance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span> (month ==<span class="st"> </span><span class="dv">1</span>, day ==<span class="st"> </span><span class="dv">1</span>, !<span class="kw">is.na</span>(air_time)) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> distance, <span class="dt">y =</span> air_time)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.05</span>)  +<span class="st">  </span>
<span class="st">  </span><span class="co"># alpha is useful for showing overlapping data points. </span>
<span class="st">  </span><span class="kw">geom_smooth</span>()</code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="01-Introduction_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p><code>air_time</code> and <code>distance</code> shows a general linear relationship. But, in comparing air time across carriers, we can do better by accounting for each case of flight destination. Let’s start with a simple apporach through removing the average air time for each destination from the air time variable and comparing the remaining variation across carriers. This is equivalent to fitting a linear regression model with fixed destination-effects and comparing residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">idx0 &lt;-<span class="st"> </span>flights %&gt;%<span class="st"> </span><span class="kw">with</span>(!<span class="kw">is.na</span>(air_time))  <span class="co"># TRUE/FALSE vector showing whther air_time is not NA. </span>
## alternatively, one can pass a variable to a custom function
<span class="co"># idx0 &lt;- flights %&gt;% select(air_time) %&gt;% (function(x) !is.na(x))</span>

flights$res &lt;-<span class="st"> </span><span class="ot">NA</span>

flights$res[idx0] &lt;-<span class="st"> </span>flights %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(air_time)) %&gt;%<span class="st"> </span>
<span class="st"> </span><span class="kw">with</span>( 
   <span class="kw">lm</span>( air_time ~<span class="st"> </span><span class="kw">as.factor</span>(dest))  
        <span class="co"># lm() means  linear model.  y ~ x specifies the formula for regressing y on x. </span>
        <span class="co"># as.factor() converts the string variable &quot;dest&quot; to a class called factor (categorical),</span>
        <span class="co">#  which gets a set of dummy variables in this regression.  </span>
   ) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="co">#  residuals(object_from_lm) retrieves residuals from the regression results of &quot;object_from_lm&quot;. </span>
<span class="st">  </span><span class="kw">residuals</span>() 

stat_res &lt;-<span class="st"> </span>flights %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(carrier) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">mean_res =</span> <span class="kw">mean</span>(res, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
    <span class="dt">sd_res =</span> <span class="kw">sd</span>(res, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
    ) 

<span class="kw">left_join</span>(stat_carrier, stat_res, <span class="dt">by=</span><span class="st">&quot;carrier&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">kable</span>(<span class="dt">digit=</span><span class="dv">2</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">carrier</th>
<th align="right">n_obs</th>
<th align="right">dep_delay</th>
<th align="right">arr_delay</th>
<th align="left">name</th>
<th align="right">mean_res</th>
<th align="right">sd_res</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">UA</td>
<td align="right">58665</td>
<td align="right">12.11</td>
<td align="right">3.56</td>
<td align="left">United Air Lines Inc.</td>
<td align="right">-0.87</td>
<td align="right">14.59</td>
</tr>
<tr class="even">
<td align="left">B6</td>
<td align="right">54635</td>
<td align="right">13.02</td>
<td align="right">9.46</td>
<td align="left">JetBlue Airways</td>
<td align="right">0.28</td>
<td align="right">11.55</td>
</tr>
<tr class="odd">
<td align="left">EV</td>
<td align="right">54173</td>
<td align="right">19.96</td>
<td align="right">15.80</td>
<td align="left">ExpressJet Airlines Inc.</td>
<td align="right">-0.37</td>
<td align="right">8.94</td>
</tr>
<tr class="even">
<td align="left">DL</td>
<td align="right">48110</td>
<td align="right">9.26</td>
<td align="right">1.64</td>
<td align="left">Delta Air Lines Inc.</td>
<td align="right">-0.20</td>
<td align="right">12.32</td>
</tr>
<tr class="odd">
<td align="left">AA</td>
<td align="right">32729</td>
<td align="right">8.59</td>
<td align="right">0.36</td>
<td align="left">American Airlines Inc.</td>
<td align="right">0.68</td>
<td align="right">13.86</td>
</tr>
<tr class="even">
<td align="left">MQ</td>
<td align="right">26397</td>
<td align="right">10.55</td>
<td align="right">10.77</td>
<td align="left">Envoy Air</td>
<td align="right">0.45</td>
<td align="right">8.87</td>
</tr>
<tr class="odd">
<td align="left">US</td>
<td align="right">20536</td>
<td align="right">3.78</td>
<td align="right">2.13</td>
<td align="left">US Airways Inc.</td>
<td align="right">-0.42</td>
<td align="right">9.43</td>
</tr>
<tr class="even">
<td align="left">9E</td>
<td align="right">18460</td>
<td align="right">16.73</td>
<td align="right">7.38</td>
<td align="left">Endeavor Air Inc.</td>
<td align="right">0.84</td>
<td align="right">8.76</td>
</tr>
<tr class="odd">
<td align="left">WN</td>
<td align="right">12275</td>
<td align="right">17.71</td>
<td align="right">9.65</td>
<td align="left">Southwest Airlines Co.</td>
<td align="right">0.16</td>
<td align="right">12.55</td>
</tr>
<tr class="even">
<td align="left">VX</td>
<td align="right">5162</td>
<td align="right">12.87</td>
<td align="right">1.76</td>
<td align="left">Virgin America</td>
<td align="right">3.26</td>
<td align="right">17.58</td>
</tr>
<tr class="odd">
<td align="left">FL</td>
<td align="right">3260</td>
<td align="right">18.73</td>
<td align="right">20.12</td>
<td align="left">AirTran Airways Corporation</td>
<td align="right">1.16</td>
<td align="right">8.75</td>
</tr>
<tr class="even">
<td align="left">AS</td>
<td align="right">714</td>
<td align="right">5.80</td>
<td align="right">-9.93</td>
<td align="left">Alaska Airlines Inc.</td>
<td align="right">-2.13</td>
<td align="right">16.17</td>
</tr>
<tr class="odd">
<td align="left">F9</td>
<td align="right">685</td>
<td align="right">20.22</td>
<td align="right">21.92</td>
<td align="left">Frontier Airlines Inc.</td>
<td align="right">3.12</td>
<td align="right">15.16</td>
</tr>
<tr class="even">
<td align="left">YV</td>
<td align="right">601</td>
<td align="right">19.00</td>
<td align="right">15.56</td>
<td align="left">Mesa Airlines Inc.</td>
<td align="right">-0.05</td>
<td align="right">7.06</td>
</tr>
<tr class="odd">
<td align="left">HA</td>
<td align="right">342</td>
<td align="right">4.90</td>
<td align="right">-6.92</td>
<td align="left">Hawaiian Airlines Inc.</td>
<td align="right">5.64</td>
<td align="right">20.69</td>
</tr>
<tr class="even">
<td align="left">OO</td>
<td align="right">32</td>
<td align="right">12.59</td>
<td align="right">11.93</td>
<td align="left">SkyWest Airlines Inc.</td>
<td align="right">1.02</td>
<td align="right">7.26</td>
</tr>
</tbody>
</table>
<p>The differences of means are small compared to standard deviations. Let’s take a case of comparison between the United Airlines and the American Airlines by t-test.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># t-test comparing UA vs AA for the mean air time </span>
flights %&gt;%
<span class="st">  </span><span class="kw">with</span>({
    idx_UA &lt;-<span class="st"> </span>carrier ==<span class="st"> &quot;UA&quot;</span>
    idx_AA &lt;-<span class="st"> </span>carrier ==<span class="st"> &quot;AA&quot;</span>
    <span class="kw">t.test</span>(res[idx_UA], res[idx_AA])
    })</code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  res[idx_UA] and res[idx_AA]
## t = -15.722, df = 68826, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.741133 -1.355142
## sample estimates:
##  mean of x  mean of y 
## -0.8689523  0.6791852</code></pre>
<p>This may be surprising, but with a large number of observations, we can detect a small difference in means, statistically speaking.</p>
<p>Let’s do this sort of comparison all at once in a regression. This can be done by using fixed effects for carriers and destinations and comparing the coefficients of carrier fixed effects. Since we used the United Airlines in the previous case, let’s set United Airlines to be a reference of carrier fixed effects. This means that the coefficient of the United is set to zero, and the coefficients of all other airlines capture the differences from the United.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights$carrier %&gt;%<span class="st"> </span><span class="kw">table</span>()</code></pre></div>
<pre><code>## .
##    9E    AA    AS    B6    DL    EV    F9    FL    HA    MQ    OO    UA 
## 18460 32729   714 54635 48110 54173   685  3260   342 26397    32 58665 
##    US    VX    WN    YV 
## 20536  5162 12275   601</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights$carrier &lt;-<span class="st"> </span><span class="kw">relevel</span>(<span class="kw">factor</span>(flights$carrier), <span class="dt">ref=</span><span class="st">&quot;UA&quot;</span>)  
  <span class="co"># reference level at the United Airlines</span>
flights$carrier %&gt;%<span class="st"> </span><span class="kw">table</span>()</code></pre></div>
<pre><code>## .
##    UA    9E    AA    AS    B6    DL    EV    F9    FL    HA    MQ    OO 
## 58665 18460 32729   714 54635 48110 54173   685  3260   342 26397    32 
##    US    VX    WN    YV 
## 20536  5162 12275   601</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f1 &lt;-<span class="st"> </span>flights %&gt;%
<span class="st"> </span><span class="kw">with</span>(
   <span class="kw">lm</span>( air_time  ~<span class="st">  </span><span class="kw">as.factor</span>(carrier) +<span class="st"> </span><span class="kw">as.factor</span>(dest) )  
    <span class="co"># fixed effects for carriers and destinations</span>
 )

<span class="co"># 119 coefficients: 16 carriers + 105 destinations - 2 (reference carrier and reference destination)</span>
<span class="kw">tidy</span>(f1)[<span class="dv">1</span>:<span class="dv">20</span>,] </code></pre></div>
<pre><code>##                    term     estimate  std.error    statistic       p.value
## 1           (Intercept)  247.9884874 0.75069658  330.3445016  0.000000e+00
## 2  as.factor(carrier)9E    1.8015498 0.12723996   14.1586788  1.702649e-45
## 3  as.factor(carrier)AA    1.9326712 0.09731105   19.8607572  1.002388e-87
## 4  as.factor(carrier)AS   -1.9071536 0.49596319   -3.8453531  1.204017e-04
## 5  as.factor(carrier)B6    1.1808039 0.08495098   13.8998267  6.535025e-44
## 6  as.factor(carrier)DL    0.7531812 0.08722600    8.6348244  5.907432e-18
## 7  as.factor(carrier)EV    0.4174574 0.11044837    3.7796605  1.570702e-04
## 8  as.factor(carrier)F9    3.8891981 0.48090201    8.0872985  6.120836e-16
## 9  as.factor(carrier)FL    2.6434074 0.27600661    9.5773336  1.002386e-21
## 10 as.factor(carrier)HA   11.0125104 0.89821710   12.2604106  1.503557e-34
## 11 as.factor(carrier)MQ    1.4592669 0.11892133   12.2708590  1.321669e-34
## 12 as.factor(carrier)OO    1.8091432 2.21222472    0.8177936  4.134757e-01
## 13 as.factor(carrier)US    0.1319337 0.13826299    0.9542230  3.399715e-01
## 14 as.factor(carrier)VX    4.5298528 0.18441295   24.5636378 4.086448e-133
## 15 as.factor(carrier)WN    1.2226161 0.17520980    6.9780125  2.999500e-12
## 16 as.factor(carrier)YV    0.5167461 0.52737831    0.9798395  3.271661e-01
## 17   as.factor(dest)ACK -207.1011095 1.04478912 -198.2228803  0.000000e+00
## 18   as.factor(dest)ALB -216.6188634 0.95130943 -227.7059972  0.000000e+00
## 19   as.factor(dest)ANC  165.1365126 4.26930687   38.6799351  0.000000e+00
## 20   as.factor(dest)ATL -136.1282095 0.75641976 -179.9638460  0.000000e+00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">with</span>({
    n_carrier &lt;-<span class="st"> </span><span class="kw">unique</span>(carrier) %&gt;%<span class="st"> </span><span class="kw">length</span>()
    n_dest &lt;-<span class="st"> </span><span class="kw">unique</span>(dest) %&gt;%<span class="st"> </span><span class="kw">length</span>() 
    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&#39;There are&#39;</span>, n_carrier, <span class="st">&#39;distinct carriers and&#39;</span>, 
                n_dest,<span class="st">&#39;distinct destinations in the data.&#39;</span> ))
  })</code></pre></div>
<pre><code>## [1] &quot;There are 16 distinct carriers and 105 distinct destinations in the data.&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_rlt1 &lt;-<span class="st"> </span><span class="kw">tidy</span>(f1) %&gt;%<span class="st"> </span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;carrier&quot;</span>,term))  
  <span class="co"># keep only rows with term-column containing &quot;carrier&quot;</span>
lm_rlt1 &lt;-<span class="st"> </span>lm_rlt1 %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">carrier =</span> <span class="kw">gsub</span>(<span class="st">&#39;as.factor</span><span class="ch">\\</span><span class="st">(carrier</span><span class="ch">\\</span><span class="st">)&#39;</span>,<span class="st">&#39;&#39;</span>, term)) 
  <span class="co"># create column named carrier </span>
lm_rlt1 &lt;-<span class="st"> </span>lm_rlt1 %&gt;%<span class="st"> </span><span class="kw">select</span>(-term)  <span class="co"># drop column term</span>

stat_carrier_base_UA &lt;-<span class="st"> </span>stat_carrier %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">dep_delay =</span> dep_delay -<span class="st"> </span>dep_delay[carrier==<span class="st">&#39;UA&#39;</span>],
    <span class="dt">arr_delay =</span> arr_delay -<span class="st"> </span>arr_delay[carrier==<span class="st">&#39;UA&#39;</span>]
    )
  
<span class="kw">left_join</span>(stat_carrier_base_UA, lm_rlt1, <span class="dt">by=</span><span class="st">&quot;carrier&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">kable</span>(<span class="dt">digit=</span><span class="dv">2</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">carrier</th>
<th align="right">n_obs</th>
<th align="right">dep_delay</th>
<th align="right">arr_delay</th>
<th align="left">name</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">UA</td>
<td align="right">58665</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="left">United Air Lines Inc.</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">B6</td>
<td align="right">54635</td>
<td align="right">0.92</td>
<td align="right">5.90</td>
<td align="left">JetBlue Airways</td>
<td align="right">1.18</td>
<td align="right">0.08</td>
<td align="right">13.90</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">EV</td>
<td align="right">54173</td>
<td align="right">7.85</td>
<td align="right">12.24</td>
<td align="left">ExpressJet Airlines Inc.</td>
<td align="right">0.42</td>
<td align="right">0.11</td>
<td align="right">3.78</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">DL</td>
<td align="right">48110</td>
<td align="right">-2.84</td>
<td align="right">-1.91</td>
<td align="left">Delta Air Lines Inc.</td>
<td align="right">0.75</td>
<td align="right">0.09</td>
<td align="right">8.63</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">AA</td>
<td align="right">32729</td>
<td align="right">-3.52</td>
<td align="right">-3.19</td>
<td align="left">American Airlines Inc.</td>
<td align="right">1.93</td>
<td align="right">0.10</td>
<td align="right">19.86</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">MQ</td>
<td align="right">26397</td>
<td align="right">-1.55</td>
<td align="right">7.22</td>
<td align="left">Envoy Air</td>
<td align="right">1.46</td>
<td align="right">0.12</td>
<td align="right">12.27</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">US</td>
<td align="right">20536</td>
<td align="right">-8.32</td>
<td align="right">-1.43</td>
<td align="left">US Airways Inc.</td>
<td align="right">0.13</td>
<td align="right">0.14</td>
<td align="right">0.95</td>
<td align="right">0.34</td>
</tr>
<tr class="even">
<td align="left">9E</td>
<td align="right">18460</td>
<td align="right">4.62</td>
<td align="right">3.82</td>
<td align="left">Endeavor Air Inc.</td>
<td align="right">1.80</td>
<td align="right">0.13</td>
<td align="right">14.16</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">WN</td>
<td align="right">12275</td>
<td align="right">5.61</td>
<td align="right">6.09</td>
<td align="left">Southwest Airlines Co.</td>
<td align="right">1.22</td>
<td align="right">0.18</td>
<td align="right">6.98</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">VX</td>
<td align="right">5162</td>
<td align="right">0.76</td>
<td align="right">-1.79</td>
<td align="left">Virgin America</td>
<td align="right">4.53</td>
<td align="right">0.18</td>
<td align="right">24.56</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">FL</td>
<td align="right">3260</td>
<td align="right">6.62</td>
<td align="right">16.56</td>
<td align="left">AirTran Airways Corporation</td>
<td align="right">2.64</td>
<td align="right">0.28</td>
<td align="right">9.58</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">AS</td>
<td align="right">714</td>
<td align="right">-6.30</td>
<td align="right">-13.49</td>
<td align="left">Alaska Airlines Inc.</td>
<td align="right">-1.91</td>
<td align="right">0.50</td>
<td align="right">-3.85</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">F9</td>
<td align="right">685</td>
<td align="right">8.11</td>
<td align="right">18.36</td>
<td align="left">Frontier Airlines Inc.</td>
<td align="right">3.89</td>
<td align="right">0.48</td>
<td align="right">8.09</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">YV</td>
<td align="right">601</td>
<td align="right">6.89</td>
<td align="right">12.00</td>
<td align="left">Mesa Airlines Inc.</td>
<td align="right">0.52</td>
<td align="right">0.53</td>
<td align="right">0.98</td>
<td align="right">0.33</td>
</tr>
<tr class="odd">
<td align="left">HA</td>
<td align="right">342</td>
<td align="right">-7.21</td>
<td align="right">-10.47</td>
<td align="left">Hawaiian Airlines Inc.</td>
<td align="right">11.01</td>
<td align="right">0.90</td>
<td align="right">12.26</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">OO</td>
<td align="right">32</td>
<td align="right">0.48</td>
<td align="right">8.37</td>
<td align="left">SkyWest Airlines Inc.</td>
<td align="right">1.81</td>
<td align="right">2.21</td>
<td align="right">0.82</td>
<td align="right">0.41</td>
</tr>
</tbody>
</table>
<p>The “estimate” column shows the mean difference in air time with the United, accounting for flight destination. The estimate tends to be more precise for carriers with larger numbers of observations. We can see the tendency that low-cost carriers like the Virgin America, the Air Tran, and the Frontier Airlines tend to show particularly longer air times than the United. Here the Hawaian Airlines shows a much longer air time. These results differ from the averages delays we calculated previously, and it may be that completely different mechanisms govern delays and air time performances.</p>
<p>Now, let’s take another step to account for flight timing. We can do this by removing the averages of air time for specific date and hour of the flight. We normally would add fixed effects for each date and hour (<code>time_hour</code> variable here). However, in this case that would mean adding nearly 7,000 dummy variables to our linear regression, which is computationally too intensive. We can approximate this estimation by subtracting the average air time for each combination of <code>time_hour</code> and <code>dest</code> from the total variation, so that the variation of <code>air time</code> is centered at zero-mean for each combination of <code>time_hour</code> and <code>dest</code>. Then, we estimate a linear model of this centered variable with destination fixed effects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Adding time_hour fixed effects is too computationally intensive 
<span class="co"># f1 &lt;- flights %&gt;%</span>
<span class="co">#  with(</span>
<span class="co">#    lm( air_time  ~  as.factor(carrier) + as.factor(dest) + as.factor(time_hour))   </span>
<span class="co">#  )</span>

<span class="kw">unique</span>(flights$time_hour) %&gt;%<span class="st"> </span><span class="kw">length</span>()  <span class="co"># 6,936 unique time_hour </span></code></pre></div>
<pre><code>## [1] 6936</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights &lt;-<span class="st"> </span>flights %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(dest, time_hour) %&gt;%<span class="st">    </span><span class="co"># group_by() for the combination of dest and time_hour</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">air_time_centered =</span> air_time -<span class="st"> </span><span class="kw">mean</span>(air_time, <span class="dt">na.rm=</span><span class="ot">TRUE</span>) 
  )

f2 &lt;-<span class="st"> </span>flights %&gt;%
<span class="st"> </span><span class="kw">with</span>(
   <span class="kw">lm</span>( air_time_centered  ~<span class="st">  </span><span class="kw">as.factor</span>(carrier) +<span class="st"> </span><span class="kw">as.factor</span>(dest) )
 )
  
lm_rlt2 &lt;-<span class="st"> </span><span class="kw">tidy</span>(f2) %&gt;%<span class="st"> </span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;carrier&quot;</span>,term)) 
lm_rlt2 &lt;-<span class="st"> </span>lm_rlt2 %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">carrier =</span> <span class="kw">gsub</span>(<span class="st">&#39;as.factor</span><span class="ch">\\</span><span class="st">(carrier</span><span class="ch">\\</span><span class="st">)&#39;</span>,<span class="st">&#39;&#39;</span>, term))  
lm_rlt2 &lt;-<span class="st"> </span>lm_rlt2 %&gt;%<span class="st"> </span><span class="kw">select</span>(-term) 

stat_carrier_base_UA2 &lt;-<span class="st">  </span>stat_carrier_base_UA %&gt;%<span class="st"> </span><span class="kw">select</span>(-<span class="kw">c</span>(dep_delay, arr_delay))
stat_carrier_rlt2 &lt;-<span class="st"> </span><span class="kw">left_join</span>(stat_carrier_base_UA2, lm_rlt2, <span class="dt">by=</span><span class="st">&quot;carrier&quot;</span>) 

stat_carrier_rlt2 %&gt;%<span class="st"> </span><span class="kw">kable</span>(<span class="dt">digit=</span><span class="dv">2</span>) <span class="co"># Note: standard errors, t-stat, and p-val are incorrect</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">carrier</th>
<th align="right">n_obs</th>
<th align="left">name</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">UA</td>
<td align="right">58665</td>
<td align="left">United Air Lines Inc.</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">B6</td>
<td align="right">54635</td>
<td align="left">JetBlue Airways</td>
<td align="right">0.82</td>
<td align="right">0.03</td>
<td align="right">32.24</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">EV</td>
<td align="right">54173</td>
<td align="left">ExpressJet Airlines Inc.</td>
<td align="right">0.88</td>
<td align="right">0.03</td>
<td align="right">26.50</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">DL</td>
<td align="right">48110</td>
<td align="left">Delta Air Lines Inc.</td>
<td align="right">0.52</td>
<td align="right">0.03</td>
<td align="right">19.85</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">AA</td>
<td align="right">32729</td>
<td align="left">American Airlines Inc.</td>
<td align="right">1.20</td>
<td align="right">0.03</td>
<td align="right">41.06</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">MQ</td>
<td align="right">26397</td>
<td align="left">Envoy Air</td>
<td align="right">1.00</td>
<td align="right">0.04</td>
<td align="right">27.84</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">US</td>
<td align="right">20536</td>
<td align="left">US Airways Inc.</td>
<td align="right">-0.09</td>
<td align="right">0.04</td>
<td align="right">-2.21</td>
<td align="right">0.03</td>
</tr>
<tr class="even">
<td align="left">9E</td>
<td align="right">18460</td>
<td align="left">Endeavor Air Inc.</td>
<td align="right">1.27</td>
<td align="right">0.04</td>
<td align="right">33.07</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">WN</td>
<td align="right">12275</td>
<td align="left">Southwest Airlines Co.</td>
<td align="right">1.30</td>
<td align="right">0.05</td>
<td align="right">24.70</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">VX</td>
<td align="right">5162</td>
<td align="left">Virgin America</td>
<td align="right">3.47</td>
<td align="right">0.06</td>
<td align="right">62.59</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">FL</td>
<td align="right">3260</td>
<td align="left">AirTran Airways Corporation</td>
<td align="right">1.78</td>
<td align="right">0.08</td>
<td align="right">21.48</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">AS</td>
<td align="right">714</td>
<td align="left">Alaska Airlines Inc.</td>
<td align="right">-2.86</td>
<td align="right">0.15</td>
<td align="right">-19.15</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">F9</td>
<td align="right">685</td>
<td align="left">Frontier Airlines Inc.</td>
<td align="right">1.99</td>
<td align="right">0.14</td>
<td align="right">13.73</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">YV</td>
<td align="right">601</td>
<td align="left">Mesa Airlines Inc.</td>
<td align="right">0.78</td>
<td align="right">0.16</td>
<td align="right">4.89</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">HA</td>
<td align="right">342</td>
<td align="left">Hawaiian Airlines Inc.</td>
<td align="right">1.34</td>
<td align="right">0.27</td>
<td align="right">4.96</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">OO</td>
<td align="right">32</td>
<td align="left">SkyWest Airlines Inc.</td>
<td align="right">3.50</td>
<td align="right">0.67</td>
<td align="right">5.26</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stat_carrier_rlt2 %&gt;%<span class="st"> </span><span class="kw">filter</span>(carrier!=<span class="st">&#39;UA&#39;</span>) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> carrier, <span class="dt">y =</span> estimate)) +<span class="st"> </span><span class="kw">geom_col</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Mean Air Time Compared to United Airlines&quot;</span>)</code></pre></div>
<p><img src="01-Introduction_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>The accuracy of this approach is influenced by the unblanaced data points for the combination of <code>time_hour</code> and <code>dest</code> since many <code>time_hour</code>-<code>dest</code> pairs do not have flights offered by all carriers. Nonetheless, the point estimate in the “estimate” column should be <em>approximately</em> close to what we would obtain if we regress <code>air_time</code> on fixed effects of <code>carrier</code>, and <code>time_hour</code>, <code>dest</code>. Note that the standard errors are not correct in the table because the centered variable has less total variation than the original <code>air_time</code> variable. (One can derive correct standard errors, for example, through bootstrapping techniques. Also, please note that formal statistical analyses will be covered in later sections.)</p>
<p>Overall, we see a tendency that low-cost carriers like the Sky West Airlines, the Virgin America, the Frontier Airlines, and the Air Tran show particularly longer air time than the United Airlines, but other low-cost carriers like the Jet Blue Airways and the Southwest Airlines show less obvious differences. The Hawaian Airlines and the Alaskan Airlines may be somewhat different from other carriers perhaps because they are more specialized in particular flight times and destimations compared to other carriers.</p>
<p>Given that the magnitude of the differnces are relatively small (e.g. less than 5 minutes), are these differences in air time important? May be not. But, we may or may not have known that those differences would be small. Is knowing that important? Well, to those who happen to believe that traditional carriers can get them to their destinations faster compared to low-cost carriers, we can point out that the <em>air time differences</em> by carrier are pretty small. Is that it (for all that work)? Anything else? Anyone? …</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="arts-carfts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reflections.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/kotamine/piecemealR/edit/master/01-Introduction.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
